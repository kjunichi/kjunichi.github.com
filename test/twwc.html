<!doctype html>

<html>

<head>
  <meta charset="utf-8" />
</head>

<body>
  <div id="vg"></div>
  <!--<script src="https://johnmyleswhite.github.io/Vega.jl/javascripts/d3.min.js"></script>
    <script src="https://johnmyleswhite.github.io/Vega.jl/javascripts/topojson.js"></script>
    <script src="https://johnmyleswhite.github.io/Vega.jl/javascripts/d3.layout.cloud.js"></script>
    <script src="https://johnmyleswhite.github.io/Vega.jl/javascripts/vega.min.js"></script>
    -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.min.js"></script>
  <script>
    const $spec = {
      "name": "wordcloud",
      "height": 400,
      "padding": "auto",
      "marks": [{
        "properties": {
          "enter": {
            "x": {
              "field": "layout_x"
            },
            "fontSize": {
              "field": "layout_fontSize"
            },
            "angle": {
              "field": "layout_rotate"
            },
            "fontWeight": {
              "field": "layout_fontWeight"
            },
            "fontStyle": {
              "field": "layout_fontStyle"
            },
            "font": {
              "field": "layout_font"
            },
            "fill": {
              "field": "text",
              "scale": "group"
            },
            "align": {
              "value": "center"
            },
            "y": {
              "field": "layout_y"
            },
            "text": {
              "field": "text"
            },
            "baseline": {
              "value": "alphabetic"
            }
          }
        },
        "from": {
          "data": "table_cprmm"
        },
        "type": "text"
      }],
      "data": [{
        "name": "table_cprmm",
        "values": [
          "textfalse", "これ", "ほんと", "そう", "だっ", "た", "。", "旅行", "で", "誰", "も", "い", "ない", "実家", "に", "行っ", "て", "プリンタ", "が", "床", "に", "落下", "し", "て", "壊れ", "て", "い", "た", "の", "写真", "に", "撮っ", "て", "おい", "たら", "、", "それで", "保険", "下り", "まし", "た", "。", "https", "://", "t", ".", "co", "/", "BpQUPLAkqKfalse", "週", "明け", "の", "小児科", "、", "流石", "に", "、", "いつも", "空い", "て", "て", "こちら", "が", "心配", "し", "て", "しまう", "くらい", "の", "近所", "の", "小児科", "医", "、", "激", "混み", "だ", "。", "false", "週末", "ブログ", "書い", "た", "ん", "だっ", "た", "。", "https", "://", "t", ".", "co", "/", "95", "qghPJvPO", "https", "://", "t", ".", "co", "/", "2", "pUOFX", "4", "dfSfalse", "“", "約", "700", "km", "の", "距離", "から", "見", "た", "リュウグウ", "の", "自転", "の", "よう", "す", "|", "トピックス", "|", "JAXA", "は", "やぶ", "さ", "２", "プロジェクト", "”", "https", "://", "t", ".", "co"
        ],

        "transform": [{
            "pattern": "[\\w']{3,}",
            "case": "upper",
            "field": "data",
            "stopwords": "(i|me|my|myself|we|us|our|ours|ourselves|you|your|yours|yourself|yourselves|he|him|his|himself|she|her|hers|herself|it|its|itself|they|them|their|theirs|themselves|what|which|who|whom|whose|this|that|these|those|am|is|are|was|were|be|been|being|have|has|had|having|do|does|did|doing|will|would|should|can|could|ought|i'm|you're|he's|she's|it's|we're|they're|i've|you've|we've|they've|i'd|you'd|he'd|she'd|we'd|they'd|i'll|you'll|he'll|she'll|we'll|they'll|isn't|aren't|wasn't|weren't|hasn't|haven't|hadn't|doesn't|don't|didn't|won't|wouldn't|shan't|shouldn't|can't|cannot|couldn't|mustn't|let's|that's|who's|what's|here's|there's|when's|where's|why's|how's|a|an|the|and|but|if|or|because|as|until|while|of|at|by|for|with|about|against|between|into|through|during|before|after|above|below|to|from|up|upon|down|in|out|on|off|over|under|again|further|then|once|here|there|when|where|why|how|all|any|both|each|few|more|most|other|some|such|no|nor|not|only|own|same|so|than|too|very|say|says|said|shall)",
            "type": "countpattern"
          },
          {
            "field": "weight",
            "expr": "if(datum.text=='VEGA', 600, 300)",
            "type": "formula"
          }, {
            "field": "angle",
            "expr": "[-45, 0, 45][~~(random() * 3)]",
            "type": "formula"
          }, {
            "fontScale": [12, 56],
            "rotate": {
              "field": "angle"
            },
            "font": {
              "value": "Helvetica Neue"
            },
            "size": [800, 400],
            "text": {
              "field": "text"
            },
            "type": "wordcloud",
            "fontSize": {
              "field": "count"
            },
            "fontWeight": {
              "field": "weight"
            }
          }, {
            "test": "datum.count > 0",
            "type": "filter"
          }, {
            "field": "group",
            "expr": "datum.text",
            "type": "formula"
          }
        ]
      }],
      "scales": [{
        "name": "group",
        "range": ["rgb(166,206,227)", "rgb( 31,120,180)", "rgb(178,223,138)", "rgb( 51,160, 44)", "rgb(251,154,153)", "rgb(227, 26, 28)", "rgb(253,191,111)", "rgb(255,127,  0)", "rgb(202,178,214)", "rgb(106, 61,154)", "rgb(255,255,153)", "rgb(177, 89, 40)"],
        "type": "ordinal"
      }],
      "width": 800
    }

    require.config({
      paths: {
        d3: "https://johnmyleswhite.github.io/Vega.jl/javascripts/d3.min",
        vega: "https://johnmyleswhite.github.io/Vega.jl/javascripts/vega.min",
        cloud: "https://johnmyleswhite.github.io/Vega.jl/javascripts/d3.layout.cloud",
        topojson: "https://johnmyleswhite.github.io/Vega.jl/javascripts/topojson"
      }
    })

    require(["d3", "topojson", "cloud"], (d3, topojson, cloud) => {
      window.d3 = d3;
      window.topojson = topojson;
      window.d3.layout.cloud = cloud;
      require(["vega"], (vg) => {
        //console.log(vg)
        vg.parse.spec($spec, function(chart) {
          chart({
            el: "#vg"
          }).update();
        });

      }) //vega require end
    }) //d3 require end

    window.onerror = (e) => {
      console.log(e)
    }
  </script>
</body>

</html>
